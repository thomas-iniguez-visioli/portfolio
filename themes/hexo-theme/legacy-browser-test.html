<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Legacy Browser Support Test - Hexo Developer Theme</title>
    
    <!-- Load legacy polyfills first -->
    <script src="source/js/legacy-polyfills.js"></script>
    
    <!-- Load CSS with legacy support -->
    <link rel="stylesheet" href="source/css/legacy-browser-support.css">
    <link rel="stylesheet" href="source/css/vendor-prefixes.css">
    <link rel="stylesheet" href="source/styles/cross-browser.css">
    <link rel="stylesheet" href="source/css/variables.css">
    <link rel="stylesheet" href="source/css/foundation/reset.css">
    <link rel="stylesheet" href="source/css/layout/grid.css">
    <link rel="stylesheet" href="source/css/sidebar.css">
    
    <style>
        /* Test styles for legacy browser verification */
        .test-section {
            margin: 2rem 0;
            padding: 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
        }
        
        .test-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #1e293b;
        }
        
        .test-description {
            color: #64748b;
            margin-bottom: 1rem;
            font-size: 0.875rem;
        }
        
        .test-result {
            padding: 0.5rem;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.875rem;
        }
        
        .test-pass {
            background-color: #dcfce7;
            color: #166534;
            border: 1px solid #bbf7d0;
        }
        
        .test-fail {
            background-color: #fef2f2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }
        
        .browser-info {
            background-color: #f1f5f9;
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 2rem;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .feature-card {
            padding: 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            background: #ffffff;
        }
        
        .demo-flexbox {
            display: flex;
            gap: 1rem;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background: #f8fafc;
            border-radius: 4px;
        }
        
        .demo-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .demo-grid-item {
            padding: 1rem;
            background: #e2e8f0;
            border-radius: 4px;
            text-align: center;
        }
        
        .demo-transform {
            width: 50px;
            height: 50px;
            background: #3b82f6;
            border-radius: 4px;
            transition: transform 0.3s ease;
        }
        
        .demo-transform:hover {
            transform: scale(1.1) rotate(5deg);
        }
        
        .demo-shadow {
            padding: 1rem;
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin: 1rem 0;
        }
        
        .demo-object-fit {
            width: 100px;
            height: 100px;
            border-radius: 8px;
            overflow: hidden;
            background: #f1f5f9;
        }
        
        .demo-object-fit img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .demo-sticky {
            position: sticky;
            top: 10px;
            background: #fbbf24;
            padding: 0.5rem;
            border-radius: 4px;
            margin: 1rem 0;
        }
        
        .demo-css-vars {
            color: var(--color-primary, #2563eb);
            background: var(--color-background, #ffffff);
            border: 1px solid var(--color-border, #e2e8f0);
            padding: 1rem;
            border-radius: var(--border-radius-base, 4px);
        }
        
        .demo-dev-sidebar {
            width: 250px;
            height: 300px;
            background: var(--dev-ide-sidebar, #252526);
            color: var(--color-neutral-100, #cccccc);
            padding: 1rem;
            border-radius: 8px;
            overflow-y: auto;
        }
        
        .demo-tech-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.5rem;
            background: var(--dev-ide-panel, #2d2d30);
            border: 1px solid var(--dev-ide-border, #3e3e42);
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.75rem;
            color: var(--color-neutral-200, #cccccc);
            margin: 0.25rem;
            transition: transform 0.15s ease;
        }
        
        .demo-tech-badge:hover {
            transform: translateY(-1px);
        }
        
        .scroll-container {
            height: 200px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            padding: 1rem;
        }
    </style>
</head>
<body>
    <div class="container" style="max-width: 1200px; margin: 0 auto; padding: 2rem;">
        <header>
            <h1>Legacy Browser Support Test</h1>
            <p>This page tests cross-browser compatibility and legacy browser support for the Hexo Developer Theme.</p>
        </header>
        
        <div class="browser-info">
            <h2>Browser Information</h2>
            <div id="browser-detection">
                <p><strong>User Agent:</strong> <span id="user-agent"></span></p>
                <p><strong>Detected Browser:</strong> <span id="detected-browser"></span></p>
                <p><strong>CSS Variables Support:</strong> <span id="css-vars-support"></span></p>
                <p><strong>CSS Grid Support:</strong> <span id="grid-support"></span></p>
                <p><strong>Flexbox Support:</strong> <span id="flexbox-support"></span></p>
                <p><strong>Object-fit Support:</strong> <span id="object-fit-support"></span></p>
                <p><strong>Sticky Support:</strong> <span id="sticky-support"></span></p>
            </div>
        </div>
        
        <div class="test-section">
            <h2 class="test-title">CSS Custom Properties Test</h2>
            <p class="test-description">Tests CSS variables support and fallbacks</p>
            <div class="demo-css-vars">
                This element uses CSS custom properties for styling. 
                In modern browsers, it should use the defined variables. 
                In older browsers, it should fall back to hardcoded values.
            </div>
            <div class="test-result" id="css-vars-result">Testing...</div>
        </div>
        
        <div class="test-section">
            <h2 class="test-title">CSS Grid Test</h2>
            <p class="test-description">Tests CSS Grid support with Flexbox fallback</p>
            <div class="demo-grid">
                <div class="demo-grid-item">Grid Item 1</div>
                <div class="demo-grid-item">Grid Item 2</div>
                <div class="demo-grid-item">Grid Item 3</div>
            </div>
            <div class="test-result" id="grid-result">Testing...</div>
        </div>
        
        <div class="test-section">
            <h2 class="test-title">Flexbox Test</h2>
            <p class="test-description">Tests Flexbox support with table fallback</p>
            <div class="demo-flexbox">
                <div>Flex Item 1</div>
                <div>Flex Item 2</div>
                <div>Flex Item 3</div>
            </div>
            <div class="test-result" id="flexbox-result">Testing...</div>
        </div>
        
        <div class="test-section">
            <h2 class="test-title">Transform and Transition Test</h2>
            <p class="test-description">Tests CSS transforms and transitions with vendor prefixes</p>
            <div style="display: flex; gap: 1rem; align-items: center;">
                <div class="demo-transform"></div>
                <p>Hover over the blue square to see transform effects</p>
            </div>
            <div class="test-result" id="transform-result">Testing...</div>
        </div>
        
        <div class="test-section">
            <h2 class="test-title">Box Shadow Test</h2>
            <p class="test-description">Tests box-shadow with vendor prefixes</p>
            <div class="demo-shadow">
                This element should have a subtle shadow effect.
            </div>
            <div class="test-result" id="shadow-result">Testing...</div>
        </div>
        
        <div class="test-section">
            <h2 class="test-title">Object-fit Test</h2>
            <p class="test-description">Tests object-fit support with positioning fallback</p>
            <div class="demo-object-fit object-fit-container">
                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iIzNiODJmNiIvPgogIDx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSJ3aGl0ZSI+VGVzdCBJbWFnZTwvdGV4dD4KPC9zdmc+" 
                     alt="Test Image" 
                     class="object-fit-cover">
            </div>
            <div class="test-result" id="object-fit-result">Testing...</div>
        </div>
        
        <div class="test-section">
            <h2 class="test-title">Sticky Positioning Test</h2>
            <p class="test-description">Tests sticky positioning with fixed fallback</p>
            <div class="scroll-container">
                <div class="demo-sticky">This should stick to the top when scrolling</div>
                <p>Scroll down in this container to test sticky positioning...</p>
                <div style="height: 500px; background: linear-gradient(to bottom, #f8fafc, #e2e8f0);">
                    <p style="padding: 2rem;">Content to scroll through...</p>
                    <p style="padding: 2rem;">More content...</p>
                    <p style="padding: 2rem;">Even more content...</p>
                    <p style="padding: 2rem;">Keep scrolling...</p>
                    <p style="padding: 2rem;">Almost there...</p>
                    <p style="padding: 2rem;">End of content</p>
                </div>
            </div>
            <div class="test-result" id="sticky-result">Testing...</div>
        </div>
        
        <div class="test-section">
            <h2 class="test-title">Developer Theme Components Test</h2>
            <p class="test-description">Tests developer-specific components with legacy support</p>
            
            <h3>Developer Sidebar Demo</h3>
            <div class="demo-dev-sidebar">
                <div style="margin-bottom: 1rem;">
                    <h4 style="color: #94a3b8; font-size: 0.75rem; margin-bottom: 0.5rem;">NAVIGATION</h4>
                    <div style="display: flex; flex-direction: column; gap: 0.25rem;">
                        <a href="#" style="color: #cccccc; text-decoration: none; padding: 0.5rem; border-radius: 4px; transition: background-color 0.15s;">Home</a>
                        <a href="#" style="color: #cccccc; text-decoration: none; padding: 0.5rem; border-radius: 4px; transition: background-color 0.15s;">Blog</a>
                        <a href="#" style="color: #cccccc; text-decoration: none; padding: 0.5rem; border-radius: 4px; transition: background-color 0.15s;">Projects</a>
                    </div>
                </div>
                
                <div>
                    <h4 style="color: #94a3b8; font-size: 0.75rem; margin-bottom: 0.5rem;">TECH STACK</h4>
                    <div style="display: flex; flex-wrap: wrap; gap: 0.25rem;">
                        <span class="demo-tech-badge">JavaScript</span>
                        <span class="demo-tech-badge">TypeScript</span>
                        <span class="demo-tech-badge">React</span>
                        <span class="demo-tech-badge">Node.js</span>
                        <span class="demo-tech-badge">CSS</span>
                    </div>
                </div>
            </div>
            <div class="test-result" id="dev-components-result">Testing...</div>
        </div>
        
        <div class="test-section">
            <h2 class="test-title">Feature Support Summary</h2>
            <p class="test-description">Summary of browser feature support and fallbacks</p>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>CSS Variables</h4>
                    <div id="feature-css-vars">Checking...</div>
                </div>
                <div class="feature-card">
                    <h4>CSS Grid</h4>
                    <div id="feature-grid">Checking...</div>
                </div>
                <div class="feature-card">
                    <h4>Flexbox</h4>
                    <div id="feature-flexbox">Checking...</div>
                </div>
                <div class="feature-card">
                    <h4>Object-fit</h4>
                    <div id="feature-object-fit">Checking...</div>
                </div>
                <div class="feature-card">
                    <h4>Sticky Position</h4>
                    <div id="feature-sticky">Checking...</div>
                </div>
                <div class="feature-card">
                    <h4>Transforms</h4>
                    <div id="feature-transforms">Checking...</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Test script to verify legacy browser support
        (function() {
            'use strict';
            
            // Display browser information
            document.getElementById('user-agent').textContent = navigator.userAgent;
            
            // Detect browser
            var browser = 'Unknown';
            if (navigator.userAgent.indexOf('MSIE') !== -1 || navigator.userAgent.indexOf('Trident') !== -1) {
                browser = 'Internet Explorer';
            } else if (navigator.userAgent.indexOf('Edge') !== -1) {
                browser = 'Microsoft Edge';
            } else if (navigator.userAgent.indexOf('Chrome') !== -1) {
                browser = 'Google Chrome';
            } else if (navigator.userAgent.indexOf('Firefox') !== -1) {
                browser = 'Mozilla Firefox';
            } else if (navigator.userAgent.indexOf('Safari') !== -1) {
                browser = 'Safari';
            }
            document.getElementById('detected-browser').textContent = browser;
            
            // Test CSS Variables support
            function testCSSVariables() {
                try {
                    return CSS.supports('--css', 'variables');
                } catch (e) {
                    return false;
                }
            }
            
            // Test CSS Grid support
            function testCSSGrid() {
                try {
                    return CSS.supports('display', 'grid');
                } catch (e) {
                    return false;
                }
            }
            
            // Test Flexbox support
            function testFlexbox() {
                try {
                    return CSS.supports('display', 'flex');
                } catch (e) {
                    return false;
                }
            }
            
            // Test Object-fit support
            function testObjectFit() {
                try {
                    return CSS.supports('object-fit', 'cover');
                } catch (e) {
                    return false;
                }
            }
            
            // Test Sticky positioning support
            function testSticky() {
                try {
                    return CSS.supports('position', 'sticky');
                } catch (e) {
                    return false;
                }
            }
            
            // Update support indicators
            var cssVarsSupport = testCSSVariables();
            var gridSupport = testCSSGrid();
            var flexboxSupport = testFlexbox();
            var objectFitSupport = testObjectFit();
            var stickySupport = testSticky();
            
            document.getElementById('css-vars-support').textContent = cssVarsSupport ? 'Supported' : 'Not Supported (using fallback)';
            document.getElementById('grid-support').textContent = gridSupport ? 'Supported' : 'Not Supported (using flexbox fallback)';
            document.getElementById('flexbox-support').textContent = flexboxSupport ? 'Supported' : 'Not Supported (using table fallback)';
            document.getElementById('object-fit-support').textContent = objectFitSupport ? 'Supported' : 'Not Supported (using positioning fallback)';
            document.getElementById('sticky-support').textContent = stickySupport ? 'Supported' : 'Not Supported (using fixed fallback)';
            
            // Update test results
            function updateTestResult(elementId, isSupported, feature) {
                var element = document.getElementById(elementId);
                if (isSupported) {
                    element.className = 'test-result test-pass';
                    element.textContent = '✓ ' + feature + ' is supported natively';
                } else {
                    element.className = 'test-result test-fail';
                    element.textContent = '⚠ ' + feature + ' not supported, using fallback';
                }
            }
            
            updateTestResult('css-vars-result', cssVarsSupport, 'CSS Variables');
            updateTestResult('grid-result', gridSupport, 'CSS Grid');
            updateTestResult('flexbox-result', flexboxSupport, 'Flexbox');
            updateTestResult('object-fit-result', objectFitSupport, 'Object-fit');
            updateTestResult('sticky-result', stickySupport, 'Sticky positioning');
            updateTestResult('transform-result', true, 'CSS Transforms'); // Assume supported with prefixes
            updateTestResult('shadow-result', true, 'Box Shadow'); // Assume supported with prefixes
            updateTestResult('dev-components-result', true, 'Developer Components');
            
            // Update feature cards
            function updateFeatureCard(elementId, isSupported) {
                var element = document.getElementById(elementId);
                if (isSupported) {
                    element.innerHTML = '<span style="color: #059669;">✓ Supported</span>';
                } else {
                    element.innerHTML = '<span style="color: #dc2626;">⚠ Fallback</span>';
                }
            }
            
            updateFeatureCard('feature-css-vars', cssVarsSupport);
            updateFeatureCard('feature-grid', gridSupport);
            updateFeatureCard('feature-flexbox', flexboxSupport);
            updateFeatureCard('feature-object-fit', objectFitSupport);
            updateFeatureCard('feature-sticky', stickySupport);
            updateFeatureCard('feature-transforms', true);
            
            // Test if polyfills are working
            if (window.LegacySupport) {
                console.log('Legacy support utilities loaded successfully');
                console.log('Browser detection:', window.LegacySupport.detectBrowser());
                console.log('Feature detection:', window.LegacySupport.detectFeatures());
            }
            
            // Add browser classes for testing
            var browserClasses = [];
            if (browser.indexOf('Internet Explorer') !== -1) browserClasses.push('browser-ie');
            if (browser.indexOf('Edge') !== -1) browserClasses.push('browser-edge');
            if (browser.indexOf('Chrome') !== -1) browserClasses.push('browser-chrome');
            if (browser.indexOf('Firefox') !== -1) browserClasses.push('browser-firefox');
            if (browser.indexOf('Safari') !== -1) browserClasses.push('browser-safari');
            
            browserClasses.forEach(function(className) {
                document.documentElement.classList.add(className);
            });
            
            console.log('Legacy browser test page loaded');
            console.log('Browser:', browser);
            console.log('CSS Variables:', cssVarsSupport);
            console.log('CSS Grid:', gridSupport);
            console.log('Flexbox:', flexboxSupport);
            console.log('Object-fit:', objectFitSupport);
            console.log('Sticky:', stickySupport);
        })();
    </script>
</body>
</html>