/**
 * Critical Performance Optimizations
 * Critical CSS inlining, lazy loading, asset optimization, and caching strategies
 * Requirements: 4.1, 4.3, 4.4
 */

/* ===== CRITICAL CSS SYSTEM ===== */

/* Critical above-the-fold styles that should be inlined */

.critical-above-fold {
  /* Essential layout variables */
  --header-height: 80px;
  --hero-min-height: 60vh;
  --sidebar-width: 300px;
  
  /* Critical font loading */
  font-display: swap;
  
  /* Prevent layout shift */
  contain: layout style;
}

/* Critical layout styles */

.critical-layout {
  /* Grid system essentials */
  display: grid;
  grid-template-columns: var(--sidebar-width) 1fr;
  grid-template-rows: auto 1fr auto;
  min-height: 100vh;
  
  /* Prevent CLS */
  contain: layout;
}

/* Critical typography */

.critical-typography {
  /* Essential font properties */
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif, sans-serif;
  font-size: 16px;
  line-height: 1.5;
  color: var(--color-text-primary);
  
  /* Font loading optimization */
  font-display: swap;
}

/* ===== FONT LOADING OPTIMIZATIONS ===== */

/* Optimized font loading with font-display: swap */

@font-face {
  font-family: 'Inter';
  src: url('/fonts/Inter-400.woff2') format('woff2');
  font-weight: 400;
  font-style: normal;
  font-display: swap; /* Requirement 4.4 */
}

@font-face {
  font-family: 'Inter';
  src: url('/fonts/Inter-500.woff2') format('woff2');
  font-weight: 500;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Inter';
  src: url('/fonts/Inter-600.woff2') format('woff2');
  font-weight: 600;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'JetBrains Mono';
  src: url('/fonts/JetBrainsMono-400.woff2') format('woff2');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'JetBrains Mono';
  src: url('/fonts/JetBrainsMono-500.woff2') format('woff2');
  font-weight: 500;
  font-style: normal;
  font-display: swap;
}

/* Font loading states for better UX */

.fonts-loading {
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif, Segoe UI, Roboto, Ubuntu, Cantarell, sans-serif;
}

.fonts-loaded {
  font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif, sans-serif;
}

.fonts-loaded code,
.fonts-loaded pre {
  font-family: 'JetBrains Mono', 'Courier New', monospace;
}

/* ===== CSS MINIFICATION AND COMPRESSION ===== */

/* Styles optimized for gzip compression - Requirement 4.3 */

.compress-optimized {
  /* Repetitive patterns compress better */
  background-image: repeating-linear-gradient(
    45deg,
    transparent,
    transparent 2px,
    rgba(255, 255, 255, 0.1) 2px,
    rgba(255, 255, 255, 0.1) 4px
  );
}

/* Minification-friendly class names */

.perf-opt { /* performance-optimized shortened for minification */
  contain: layout style paint;
  will-change: transform, opacity;
}

.perf-opt.complete {
  will-change: auto;
}

/* ===== LAZY LOADING SYSTEM ===== */

/* Non-critical CSS lazy loading support */

.lazy-css {
  /* Placeholder for lazy-loaded styles */
  opacity: 0;
  transition: opacity 0.3s ease-in-out;
}

.lazy-css.loaded {
  opacity: 1;
}

/* ===== CRITICAL RESOURCE HINTS ===== */

/* Mark critical resources for preloading */

.preload-critical {
  /* Critical resources that should be preloaded:
   * - Above-the-fold images
   * - Critical fonts
   * - Essential JavaScript
   */
}

/* ===== PERFORMANCE MONITORING ===== */

/* Core Web Vitals optimization markers */

.fcp-optimized {
  /* First Contentful Paint optimization - Requirement 4.1 */
  contain: layout style paint;
  content-visibility: auto;
}

.lcp-optimized {
  /* Largest Contentful Paint optimization - Requirement 4.1 */
  content-visibility: auto;
  contain-intrinsic-size: 800px 600px;
}

.cls-stable {
  /* Cumulative Layout Shift prevention - Requirement 4.1 */
  aspect-ratio: 16 / 9;
  width: 100%;
  height: auto;
}

.fid-optimized {
  /* First Input Delay optimization - Requirement 4.1 */
  pointer-events: auto;
  touch-action: manipulation;
}

/* ===== BANDWIDTH OPTIMIZATIONS ===== */

/* Reduced data mode support */

@media (prefers-reduced-data: reduce) {
  .optional-image {
    display: none;
  }
  
  .complex-animation {
    animation: none;
  }
  
  .gradient-background {
    background: var(--color-background-secondary);
  }
}

/* ===== CRITICAL CSS INLINING MARKERS ===== */

/* These styles should be extracted and inlined in HTML head - Requirement 4.1 */

.inline-critical {
  /* Essential layout */
  display: grid;
  grid-template-columns: 300px 1fr;
  min-height: 100vh;
  
  /* Essential typography */
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif;
  font-size: 16px;
  line-height: 1.5;
  
  /* Essential colors */
  color: #0f172a;
  background-color: #ffffff;
}

/* ===== ASSET OPTIMIZATION ===== */

/* Optimized image loading */

.optimized-image {
  /* Modern image formats with fallbacks */
  content: url('/images/optimized.avif');
  
  /* Fallback for browsers without AVIF support */
  content: url('/images/optimized.webp');
  
  /* Final fallback */
  content: url('/images/optimized.jpg');
  
  /* Performance optimizations */
  loading: lazy;
  decoding: async;
  width: 100%;
  height: auto;
}

/* ===== COMPRESSION UTILITIES ===== */

/* Utilities that compress well with gzip/brotli */

.compress-friendly {
  /* Use consistent patterns */
  margin: 1rem;
  padding: 1rem;
  border-radius: 0.5rem;
  
  /* Avoid unique values that don't compress well */
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

/* ===== CRITICAL PATH OPTIMIZATION ===== */

/* Styles for critical rendering path optimization */

.critical-path {
  /* Minimize reflows and repaints */
  transform: translateZ(0);
  -webkit-backface-visibility: hidden;
          backface-visibility: hidden;
  perspective: 1000px;
  
  /* Use efficient properties */
  will-change: transform, opacity;
}

.critical-path.complete {
  will-change: auto;
}