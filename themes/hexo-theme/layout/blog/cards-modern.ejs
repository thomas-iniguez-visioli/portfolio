<%# 
  Modern Cards Component
  Responsive grid layout with hover effects and loading states
%>

<section class="section" aria-labelledby="projects-title">
  <div class="container">
    <header class="section-header">
      <h2 id="projects-title" class="heading-title text-3xl mb-4">
        Derniers Articles
      </h2>
      <p class="text-secondary text-lg mb-8">
        Découvrez mes dernières réflexions sur le développement web, les technologies modernes et les bonnes pratiques.
      </p>
    </header>

    <!-- Featured Article (if exists) -->
    <% if (typeof featuredPost !== 'undefined' && featuredPost) { %>
      <div class="cards-grid mb-12">
        <article class="card card-featured" itemscope itemtype="https://schema.org/Article">
          <div class="card-content">
            <div class="card-header">
              <div class="card-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                  <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                </svg>
              </div>
              <div>
                <p class="card-subtitle">Article en vedette</p>
                <h3 class="card-title" itemprop="name">
                  <a href="<%= url_for(featuredPost.path) %>" rel="bookmark">
                    <%= featuredPost.title %>
                  </a>
                </h3>
              </div>
            </div>
            
            <p class="card-description" itemprop="abstract">
              <%- featuredPost.excerpt || strip_html(featuredPost.content).substring(0, 200) + '...' %>
            </p>
            
            <div class="card-meta">
              <time class="card-date" itemprop="datePublished" datetime="<%= featuredPost.date.toISOString() %>">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                  <line x1="16" y1="2" x2="16" y2="6"></line>
                  <line x1="8" y1="2" x2="8" y2="6"></line>
                  <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
                <%= date(featuredPost.date) %>
              </time>
              
              <span class="card-reading-time">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12,6 12,12 16,14"></polyline>
                </svg>
                <%= readingTime(featuredPost.content).text %>
              </span>
            </div>
            
            <% if (featuredPost.tags && featuredPost.tags.length > 0) { %>
              <div class="card-tags">
                <% featuredPost.tags.forEach(tag => { %>
                  <a href="<%= url_for(tag.path) %>" class="card-tag">
                    <%= tag.name %>
                  </a>
                <% }) %>
              </div>
            <% } %>
          </div>
          
          <% if (featuredPost.cover || featuredPost.image) { %>
            <div class="card-image-wrapper">
              <img src="<%= featuredPost.image || featuredPost.cover %>" 
                   alt="<%= featuredPost.title %>" 
                   class="card-image"
                   loading="lazy"
                   itemprop="thumbnailUrl">
            </div>
          <% } %>
          
          <div class="card-badge card-badge-success">Nouveau</div>
        </article>
      </div>
    <% } %>

    <!-- Regular Articles Grid -->
    <div class="cards-grid">
      <% (posts || []).forEach(post => { %>
        <article class="card" itemscope itemtype="https://schema.org/Article">
          <% if (post.cover || post.image) { %>
            <div class="card-image-wrapper">
              <img src="<%= post.image || post.cover %>" 
                   alt="<%= post.title %>" 
                   class="card-image"
                   loading="lazy"
                   itemprop="thumbnailUrl">
            </div>
          <% } %>
          
          <div class="card-content">
            <div class="card-header">
              <div class="card-icon">
                <% if (post.layout === 'reading-note') { %>
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                    <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                  </svg>
                <% } else if (post.layout === 'journal') { %>
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14,2 14,8 20,8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                    <polyline points="10,9 9,9 8,9"></polyline>
                  </svg>
                <% } else { %>
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14,2 14,8 20,8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                  </svg>
                <% } %>
              </div>
              <div>
                <p class="card-subtitle">
                  <% if (post.layout === 'reading-note') { %>
                    Note de lecture
                  <% } else if (post.layout === 'journal') { %>
                    Journal
                  <% } else { %>
                    Article
                  <% } %>
                </p>
                <h3 class="card-title" itemprop="name">
                  <a href="<%= url_for(post.path) %>" rel="bookmark">
                    <%= post.title %>
                  </a>
                </h3>
              </div>
            </div>
            
            <p class="card-description" itemprop="abstract">
              <%- post.excerpt || strip_html(post.content).substring(0, 150) + '...' %>
            </p>
            
            <div class="card-meta">
              <time class="card-date" itemprop="datePublished" datetime="<%= post.date.toISOString() %>">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                  <line x1="16" y1="2" x2="16" y2="6"></line>
                  <line x1="8" y1="2" x2="8" y2="6"></line>
                  <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
                <%= date(post.date) %>
              </time>
              
              <span class="card-reading-time">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12,6 12,12 16,14"></polyline>
                </svg>
                <%= readingTime(post.content).text %>
              </span>
            </div>
            
            <% if (post.tags && post.tags.length > 0) { %>
              <div class="card-tags">
                <% post.tags.slice(0, 3).forEach(tag => { %>
                  <a href="<%= url_for(tag.path) %>" class="card-tag">
                    <%= tag.name %>
                  </a>
                <% }) %>
                <% if (post.tags.length > 3) { %>
                  <span class="card-tag">+<%= post.tags.length - 3 %></span>
                <% } %>
              </div>
            <% } %>
          </div>
        </article>
      <% }) %>
    </div>

    <!-- Loading State Template (for JavaScript) -->
    <template id="card-loading-template">
      <div class="card card-loading">
        <div class="card-skeleton card-skeleton-image"></div>
        <div class="card-content">
          <div class="card-skeleton card-skeleton-title"></div>
          <div class="card-skeleton card-skeleton-text"></div>
          <div class="card-skeleton card-skeleton-text"></div>
          <div class="card-skeleton card-skeleton-text"></div>
        </div>
      </div>
    </template>

    <!-- View More Button -->
    <div class="text-center mt-12">
      <a href="<%= url_for('/archives/') %>" class="hero-cta">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
          <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
        </svg>
        Voir tous les articles
      </a>
    </div>
  </div>
</section>