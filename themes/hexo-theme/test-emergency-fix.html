<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Correction d'Urgence - Superposition</title>
    
    <!-- CSS de base -->
    <link rel="stylesheet" href="source/styles/reset.css">
    <link rel="stylesheet" href="source/styles/variables.css">
    <link rel="stylesheet" href="source/styles/layout.css">
    <link rel="stylesheet" href="source/styles/header.css">
    <link rel="stylesheet" href="source/styles/sidebar.css">
    <link rel="stylesheet" href="source/styles/buttons.css">
    <link rel="stylesheet" href="source/styles/cards.css">
    <link rel="stylesheet" href="source/css/dev-components.css">
    
    <!-- CORRECTION D'URGENCE - √Ä CHARGER EN DERNIER -->
    <link rel="stylesheet" href="source/css/layering-emergency-fix.css">
    
    <style>
        /* Styles de test */
        .test-content {
            padding: 2rem;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .test-section {
            margin: 2rem 0;
            padding: 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            background: #f8fafc;
        }
        
        .test-button {
            margin: 0.5rem;
            padding: 0.5rem 1rem;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .status-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #059669;
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            z-index: 9999;
        }
    </style>
</head>
<body class="dev-layout modern-layout">
    <!-- Indicateur de statut -->
    <div class="status-indicator">
        üîß Corrections Actives
    </div>
    
    <!-- Skip link -->
    <a href="#main-content" class="dev-skip-link skip-link">Aller au contenu</a>
    
    <div class="dev-page-grid page-grid">
        <!-- Header -->
        <header class="page-header dev-header">
            <div class="container">
                <div class="header-content">
                    <div class="header-brand">
                        <a href="#" class="brand-link">
                            <span class="brand-text">Test Corrections</span>
                        </a>
                    </div>
                    
                    <nav class="header-nav">
                        <button class="nav-toggle" aria-expanded="false">
                            <span class="nav-toggle-icon"></span>
                            <span class="nav-toggle-icon"></span>
                            <span class="nav-toggle-icon"></span>
                        </button>
                        
                        <ul class="nav-menu">
                            <li class="nav-item">
                                <a href="#" class="nav-link">Accueil</a>
                            </li>
                            <li class="nav-item">
                                <a href="#" class="nav-link">Test</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </header>
        
        <!-- Contenu principal -->
        <main class="dev-page-main page-main" role="main" id="main-content">
            <div class="dev-layout-container layout-with-sidebar">
                <!-- Sidebar -->
                <aside class="dev-sidebar" id="dev-sidebar">
                    <div class="dev-sidebar-content">
                        <div class="dev-sidebar-section">
                            <h3>Menu</h3>
                            <ul class="dev-nav-list">
                                <li class="dev-nav-item">
                                    <a href="#" class="dev-nav-link active">
                                        <span class="dev-nav-text">Accueil</span>
                                    </a>
                                </li>
                                <li class="dev-nav-item">
                                    <a href="#" class="dev-nav-link">
                                        <span class="dev-nav-text">Test</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                        
                        <div class="dev-sidebar-section">
                            <h4>Technologies</h4>
                            <div class="dev-tech-badges">
                                <span class="dev-tech-badge javascript">JS</span>
                                <span class="dev-tech-badge react">React</span>
                                <span class="dev-tech-badge node">Node</span>
                            </div>
                        </div>
                    </div>
                </aside>
                
                <!-- Toggle mobile -->
                <button class="dev-sidebar-toggle" aria-expanded="false">
                    <div class="dev-sidebar-toggle-icon">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </button>
                
                <!-- Contenu principal -->
                <div class="dev-main-content main-content">
                    <div class="test-content">
                        <h1>Test des Corrections d'Urgence</h1>
                        <p>Cette page teste les corrections d'urgence pour les probl√®mes de superposition.</p>
                        
                        <div class="test-section">
                            <h2>Test 1: Header Sticky</h2>
                            <p>Le header doit rester en haut lors du scroll.</p>
                            <p><strong>Status:</strong> <span id="header-status">En cours de v√©rification...</span></p>
                        </div>
                        
                        <div class="test-section">
                            <h2>Test 2: Sidebar Mobile</h2>
                            <p>La sidebar doit s'ouvrir/fermer correctement sur mobile.</p>
                            <p><strong>Status:</strong> <span id="sidebar-status">En cours de v√©rification...</span></p>
                            <button class="test-button" onclick="testSidebar()">Tester Sidebar</button>
                        </div>
                        
                        <div class="test-section">
                            <h2>Test 3: Z-Index</h2>
                            <p>Les z-index doivent √™tre correctement d√©finis.</p>
                            <p><strong>Status:</strong> <span id="zindex-status">En cours de v√©rification...</span></p>
                            <button class="test-button" onclick="testZIndex()">V√©rifier Z-Index</button>
                        </div>
                        
                        <div class="test-section">
                            <h2>Test 4: Cartes</h2>
                            <p>Les cartes ne doivent pas se chevaucher.</p>
                            <div class="cards-grid">
                                <div class="card">
                                    <div class="card-content">
                                        <h3 class="card-title">Carte 1</h3>
                                        <p class="card-description">Contenu de test.</p>
                                    </div>
                                </div>
                                <div class="card">
                                    <div class="card-content">
                                        <h3 class="card-title">Carte 2</h3>
                                        <p class="card-description">Contenu de test.</p>
                                    </div>
                                </div>
                                <div class="card">
                                    <div class="card-content">
                                        <h3 class="card-title">Carte 3</h3>
                                        <p class="card-description">Contenu de test.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="test-section">
                            <h2>Test 5: Boutons</h2>
                            <p>Les boutons doivent fonctionner correctement.</p>
                            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                <button class="btn btn-primary">Primary</button>
                                <button class="btn btn-secondary">Secondary</button>
                                <button class="btn btn-terminal">Terminal</button>
                                <button class="btn btn-ghost">Ghost</button>
                            </div>
                        </div>
                        
                        <!-- Contenu long pour tester le scroll -->
                        <div class="test-section">
                            <h2>Contenu Long (Test Scroll)</h2>
                            <p>Ce contenu permet de tester le comportement du header sticky lors du scroll.</p>
                            <div style="height: 200vh; background: linear-gradient(to bottom, #f8fafc, #e2e8f0); padding: 2rem; border-radius: 8px;">
                                <p>Scrollez pour tester le header sticky...</p>
                                <div style="position: absolute; bottom: 2rem;">
                                    <p>Fin du contenu de test</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Modal de test -->
    <div class="modal" id="test-modal" style="display: none;">
        <div class="modal-backdrop"></div>
        <div class="modal-container">
            <div class="modal-header">
                <h3>Modal de Test</h3>
                <button onclick="closeModal()">√ó</button>
            </div>
            <div class="modal-content">
                <p>Cette modal teste le z-index.</p>
                <button class="test-button" onclick="closeModal()">Fermer</button>
            </div>
        </div>
    </div>
    
    <!-- SCRIPT DE CORRECTION D'URGENCE - √Ä CHARGER EN DERNIER -->
    <script src="source/js/layering-emergency-fix.js"></script>
    
    <script>
        // Tests automatiques
        function runTests() {
            // Test header
            const header = document.querySelector('.page-header, .dev-header');
            const headerStatus = document.getElementById('header-status');
            if (header) {
                const position = window.getComputedStyle(header).position;
                const zIndex = window.getComputedStyle(header).zIndex;
                if (position === 'sticky' && parseInt(zIndex) >= 1100) {
                    headerStatus.textContent = '‚úÖ OK - Header sticky avec z-index ' + zIndex;
                    headerStatus.style.color = 'green';
                } else {
                    headerStatus.textContent = '‚ùå Probl√®me - Position: ' + position + ', Z-index: ' + zIndex;
                    headerStatus.style.color = 'red';
                }
            }
            
            // Test sidebar
            const sidebar = document.querySelector('.dev-sidebar, #dev-sidebar');
            const sidebarStatus = document.getElementById('sidebar-status');
            if (sidebar) {
                const position = window.getComputedStyle(sidebar).position;
                const zIndex = window.getComputedStyle(sidebar).zIndex;
                const expectedPosition = window.innerWidth <= 1023 ? 'fixed' : 'sticky';
                if (position === expectedPosition) {
                    sidebarStatus.textContent = '‚úÖ OK - Sidebar ' + position + ' avec z-index ' + zIndex;
                    sidebarStatus.style.color = 'green';
                } else {
                    sidebarStatus.textContent = '‚ùå Probl√®me - Position: ' + position + ' (attendu: ' + expectedPosition + ')';
                    sidebarStatus.style.color = 'red';
                }
            }
            
            // Test z-index
            testZIndex();
        }
        
        function testSidebar() {
            const sidebar = document.querySelector('.dev-sidebar, #dev-sidebar');
            const toggle = document.querySelector('.dev-sidebar-toggle');
            
            if (sidebar && toggle) {
                // Simuler un clic sur le toggle
                toggle.click();
                
                setTimeout(() => {
                    const isOpen = sidebar.classList.contains('dev-sidebar-open') || 
                                   sidebar.classList.contains('dev-sidebar--open');
                    alert(isOpen ? 'Sidebar ouverte ‚úÖ' : 'Sidebar ferm√©e ‚ùå');
                }, 300);
            } else {
                alert('Sidebar ou toggle non trouv√© ‚ùå');
            }
        }
        
        function testZIndex() {
            const elements = {
                'Header': document.querySelector('.page-header, .dev-header'),
                'Sidebar': document.querySelector('.dev-sidebar, #dev-sidebar'),
                'Toggle': document.querySelector('.dev-sidebar-toggle')
            };
            
            let results = [];
            Object.entries(elements).forEach(([name, element]) => {
                if (element) {
                    const zIndex = window.getComputedStyle(element).zIndex;
                    results.push(`${name}: ${zIndex}`);
                }
            });
            
            const zindexStatus = document.getElementById('zindex-status');
            zindexStatus.innerHTML = '‚úÖ Z-Index: ' + results.join(', ');
            zindexStatus.style.color = 'green';
        }
        
        function openModal() {
            document.getElementById('test-modal').style.display = 'flex';
        }
        
        function closeModal() {
            document.getElementById('test-modal').style.display = 'none';
        }
        
        // Ajouter bouton pour ouvrir modal
        document.addEventListener('DOMContentLoaded', function() {
            const button = document.createElement('button');
            button.textContent = 'Test Modal';
            button.className = 'test-button';
            button.onclick = openModal;
            document.querySelector('.test-content').appendChild(button);
            
            // Lancer les tests apr√®s un d√©lai
            setTimeout(runTests, 1500);
            
            // Relancer les tests lors du redimensionnement
            window.addEventListener('resize', () => {
                setTimeout(runTests, 500);
            });
        });
        
        // Debug console
        console.log('üß™ Page de test charg√©e');
        console.log('EmergencyFix disponible:', window.EmergencyFix);
        
        // Fonction de debug globale
        window.debugLayering = function() {
            console.log('=== DEBUG LAYERING ===');
            console.log('Window size:', window.innerWidth + 'x' + window.innerHeight);
            
            const elements = ['header', '.page-header', '.dev-header', '.dev-sidebar', '#dev-sidebar', '.dev-sidebar-toggle'];
            elements.forEach(selector => {
                const el = document.querySelector(selector);
                if (el) {
                    const style = window.getComputedStyle(el);
                    console.log(selector + ':', {
                        position: style.position,
                        zIndex: style.zIndex,
                        display: style.display,
                        transform: style.transform
                    });
                }
            });
            
            if (window.EmergencyFix) {
                console.log('R√©application des corrections...');
                window.EmergencyFix.init();
            }
        };
    </script>
    
    <!-- Bouton de debug -->
    <div style="position: fixed; bottom: 20px; left: 20px; z-index: 9999;">
        <button onclick="debugLayering()" style="background: #dc2626; color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; font-size: 12px;">
            üêõ Debug
        </button>
    </div>
</body>
</html>